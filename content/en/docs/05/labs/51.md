---
title: "5.1 Tasks: kube-prometheus metrics"
weight: 5
sectionnumber: 5.1
---

### Task {{% param sectionnumber %}}.1: Memory usage of Prometheus

**Task description**:

* Display the memory usage of both Prometheus pods
* Use a filter to just display metrics from your `prometheus` containers

{{% alert title="Note" color="primary" %}}
Search for a metric with `memory_working_set` in its name
{{% /alert %}}

{{% details title="Hints" mode-switcher="normalexpertmode" %}}
{{% onlyWhenNot baloise %}}

```promql
container_memory_working_set_bytes{pod=~"prometheus-k8s-.*", container="prometheus"}
```
{{% /onlyWhenNot %}}
{{% onlyWhen baloise %}}

```promql
container_memory_working_set_bytes{namespace="<team>-monitoring", pod=~"prometheus-prometheus-.*", container="prometheus"}
```
{{% /onlyWhen %}}

{{% /details %}}

### Task {{% param sectionnumber %}}.2: Kubernetes pod count

**Task description**:

* Display how many pods are currently running on your Kubernetes platform

{{% details title="Hints" mode-switcher="normalexpertmode" %}}

There are different ways to archive this. You can for example query all running containers and group them by `pod` and `namespace`.

```promql
count(sum(kube_pod_container_status_running == 1) by (pod,namespace,cluster))
```

You may also sum() all running pods on your Kubernetes nodes

```promql
sum(kubelet_running_pods)
```

{{% onlyWhen baloise %}}

{{% alert title="Note" color="primary" %}}
The result counts only the pods on the clusters that you actually use. Therefore, this number may be different for each monitoring stack.
There may be a minor discrepancy between the two options, as the platform is constantly changing and different jobs query the targets at different times.
{{% /alert %}}

{{% /onlyWhen %}}

{{% /details %}}
